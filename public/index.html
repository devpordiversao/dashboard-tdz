<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TDZ Bot Dashboard</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Arial, sans-serif; background: linear-gradient(135deg,#161620,#1e1e2e); color:#fff; padding:20px; }
.navbar { background:#2a2a3e; padding:20px; border-radius:10px; margin-bottom:20px; display:flex; justify-content:space-between; align-items:center; }
h1 { color:#5865F2; }
.card { background:#2a2a3e; padding:20px; border-radius:10px; margin-bottom:20px; }
.tabs { display:flex; gap:10px; margin-bottom:20px; border-bottom:2px solid #444; }
.tab { padding:10px 20px; cursor:pointer; border-bottom:3px solid transparent; }
.tab.active { color:#5865F2; border-bottom-color:#5865F2; }
.tab-content { display:none; }
.tab-content.active { display:block; }
input,textarea,select { width:100%; padding:10px; margin:10px 0; background:#161620; border:2px solid #444; border-radius:5px; color:#fff; }
.btn { padding:10px 20px; margin:5px; border:none; border-radius:5px; cursor:pointer; font-weight:bold; }
.btn-primary { background:#5865F2; color:white; }
.btn-success { background:#43B581; color:white; }
.btn-danger { background:#F04747; color:white; }
.logs { background:#000; padding:15px; border-radius:5px; max-height:300px; overflow-y:auto; font-family:monospace; }
.log-entry { padding:5px 0; }
.info { color:#43B581; }
.error { color:#F04747; }
.warning { color:#FAA61A; }
</style>
</head>
<body>

<div class="navbar">
<h1>ğŸ¤– TDZ Bot Dashboard</h1>
<div>Status: <span id="status">Offline</span></div>
</div>

<div class="card">
<h2>Servidores: <span id="serverCount">0</span></h2>
<div id="serversList"></div>
</div>

<div class="card">
<div class="tabs">
<div class="tab active" onclick="showTab('messages')">ğŸ“¨ Mensagens</div>
<div class="tab" onclick="showTab('channels')">ğŸ“ Canais</div>
<div class="tab" onclick="showTab('roles')">ğŸ­ Cargos</div>
<div class="tab" onclick="showTab('commands')">âš¡ Comandos</div>
</div>

<div class="tab-content active" id="messages">
<label>Canal:</label>
<select id="channelSelect"></select>
<label>Mensagem:</label>
<textarea id="messageText" rows="4"></textarea>
<button class="btn btn-primary" onclick="sendMessage()">ğŸ“¨ Enviar</button>
</div>

<div class="tab-content" id="channels">
<label>Nome do Canal:</label>
<input type="text" id="channelName">
<label>Tipo:</label>
<select id="channelType">
<option>Texto</option>
<option>Voz</option>
</select>
<button class="btn btn-primary" onclick="createChannel()">â• Criar Canal</button>
</div>

<div class="tab-content" id="roles">
<label>UsuÃ¡rio:</label>
<select id="userSelect"></select>
<label>Cargo:</label>
<select id="roleSelect"></select>
<button class="btn btn-success" onclick="giveRole()">â• Dar Cargo</button>
<button class="btn btn-danger" onclick="removeRole()">â– Remover</button>
</div>

<div class="tab-content" id="commands">
<h3>Comandos RÃ¡pidos</h3>
<button class="btn btn-primary" onclick="runCommand('embed')">ğŸ–¼ï¸ Embed</button>
<button class="btn btn-primary" onclick="runCommand('sugerir')">ğŸ’¡ Sugerir</button>
<button class="btn btn-primary" onclick="runCommand('stats')">ğŸ“Š Stats</button>
<button class="btn btn-primary" onclick="runCommand('relatorio')">ğŸ“‹ RelatÃ³rio</button>
<button class="btn btn-primary" onclick="runCommand('backup')">ğŸ’¾ Backup</button>
<br><br>
<button class="btn btn-success" onclick="startBot()">â–¶ï¸ Iniciar Bot</button>
<button class="btn btn-danger" onclick="stopBot()">â¹ï¸ Parar Bot</button>
</div>
</div>

<div class="card">
<h2>ğŸ“‹ Logs <button class="btn btn-danger" onclick="clearLogs()">Limpar</button></h2>
<div class="logs" id="logs"></div>
</div>

<script>
function showTab(tab){
document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
event.target.classList.add('active');
document.getElementById(tab).classList.add('active');
}

function addLog(type,msg){
const log=document.getElementById('logs');
const entry=document.createElement('div');
entry.className='log-entry '+type;
entry.textContent=`[${new Date().toLocaleTimeString()}] ${msg}`;
log.appendChild(entry);
log.scrollTop=log.scrollHeight;
}

function clearLogs(){document.getElementById('logs').innerHTML='';}

// Simula preenchimento dos dropdowns
function populateDropdowns(){
fetch('/api/get-users')
.then(r=>r.json())
.then(data=>{
const userSelect=document.getElementById('userSelect');
userSelect.innerHTML='';
data.forEach(u=>{
let opt=document.createElement('option');
opt.value=u.id; opt.text=u.username; userSelect.appendChild(opt);
});
});

fetch('/api/get-roles')
.then(r=>r.json())
.then(data=>{
const roleSelect=document.getElementById('roleSelect');
roleSelect.innerHTML='';
data.forEach(r=>{
let opt=document.createElement('option');
opt.value=r.id; opt.text=r.name; roleSelect.appendChild(opt);
});
});

fetch('/api/get-channels')
.then(r=>r.json())
.then(data=>{
const channelSelect=document.getElementById('channelSelect');
channelSelect.innerHTML='';
data.forEach(c=>{
let opt=document.createElement('option');
opt.value=c.id; opt.text=c.name; channelSelect.appendChild(opt);
});
});
}

// AÃ§Ãµes do dashboard
function sendMessage(){
const canal=document.getElementById('channelSelect').value;
const msg=document.getElementById('messageText').value;
fetch('/api/send-message',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({channelId:canal,message:msg})})
.then(r=>r.json()).then(r=>addLog('info','Mensagem enviada!')).catch(e=>addLog('error','Erro ao enviar'));
}

function createChannel(){
const name=document.getElementById('channelName').value;
const type=document.getElementById('channelType').value;
fetch('/api/create-channel',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({guildId:'SERVIDOR_ID_AQUI',name:name,type:type})})
.then(r=>r.json()).then(r=>addLog('info','Canal '+r.name+' criado!')).catch(e=>addLog('error','Erro ao criar canal'));
}

function giveRole(){
const user=document.getElementById('userSelect').value;
const role=document.getElementById('roleSelect').value;
fetch('/api/give-role',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:user,roleId:role})})
.then(r=>r.json()).then(r=>addLog('info','Cargo dado!')).catch(e=>addLog('error','Erro ao dar cargo'));
}

function removeRole(){
const user=document.getElementById('userSelect').value;
const role=document.getElementById('roleSelect').value;
fetch('/api/remove-role',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:user,roleId:role})})
.then(r=>r.json()).then(r=>addLog('info','Cargo removido!')).catch(e=>addLog('error','Erro ao remover cargo'));
}

function runCommand(cmd){
let params={};
if(cmd==='embed') params={canal:prompt('ID do canal'),titulo:prompt('TÃ­tulo'),descricao:prompt('DescriÃ§Ã£o'),cor:prompt('Cor HEX ex:#5865F2')};
if(cmd==='sugerir') params={sugestao:prompt('SugestÃ£o')};
fetch('/api/command',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({command:cmd,params:params})})
.then(r=>r.json()).then(r=>addLog('info','Comando '+cmd+' executado!')).catch(e=>addLog('error','Erro no comando '+cmd));
}

function startBot(){document.getElementById('status').textContent='Online'; addLog('info','Bot iniciado');}
function stopBot(){document.getElementById('status').textContent='Offline'; addLog('error','Bot parado');}

// Inicializa
addLog('info','Dashboard pronto');
populateDropdowns();
</script>

</body>
    </html>
